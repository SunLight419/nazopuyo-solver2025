# 謎ぷよソルバー仕様

# 概要

与えられた謎ぷよを、探索することによって解を探索する。

# 開発環境

Rust言語

現状はcliツールを予定しているが、将来的にはtauriなどを用いてguiに対応したい。

そのため、コアな機能はlibとして実装する。

# ぷよぷよ

ぷよぷよは、高さ13マス、幅6マスのフィールドに、ぷよと呼ばれる色つきの玉のようなものを配置していくゲームである。ぷよは重力に従い落下し、４つ以上同じ色のぷよが連結すると、その連結したぷよが消滅する。消滅後、その上にあったぷよが落下し、新たに消滅が起こることがある。これを連鎖という。

ぷよぷよの特殊な制約として、すべてのぷよが落下し、連鎖が起こらない状態で、左から３番目、上から２番目のマスがぷよで埋まっていると、ゲームオーバーとなる。

また、画面の一番上にあるマスにあるぷよは、連結数にカウントされない。

# 謎ぷよ

謎ぷよは、ある状態の盤面と、次に降ってくるぷよの組み合わせ（ネクストぷよ、２個で１組）、および目標（○連鎖せよ、というものが主流）がいくつか与えられる。ぷよの置き方は、重複を考えない場合に１手22通りあるため、長手数のネクストぷよが与えられると難易度が高くなる（たとえば、6手問題は 22^6 = 113379904 通り）。

# 計算速度

上記のように、謎ぷよ探索は、非常に多くの解の候補があるため、できるだけ高速なプログラムを作成したい。高速化のヒントとして、以下の要素などがある

- ハッシュ
- bitboard
- flood-fill
- 枝刈り
    - 途中で連鎖が起こるものは不適
    - 3つ以下のぷよでは連鎖が発生しない
- （最終手段）マルチスレッド

---
# やること
まずは、ぷよの基本となる操作を抽出したtraitを作成してください。
これは後々、実装方法を色々切り替えて、性能を比較するために必要です。
また、これらの機能はコアとなるので、coreというライブラリで実装したいです。
traitには、最低限以下の要素が必要です：
- ぷよをおく
- あるマスのぷよを確認する
- 落下させる
- 連鎖する
- 表示する